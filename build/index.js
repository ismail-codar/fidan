function e(e){var n=this,t=[];function r(e){e in n||Object.defineProperty(n,e,{configurable:!0,enumerable:!0,get:function(){return t[e]},set:function(n){t[e]=n,i({type:"itemset",index:e,item:n})}})}function i(e){n._handlers[e.type].forEach(function(t){t.call(n,e)})}n._handlers={itemadded:[],itemremoved:[],itemset:[],beforemulti:[],aftermulti:[]},n.on=function(e,t){n._handlers[e].push(t)},n.off=function(e,t){for(var r=n._handlers[e],i=r.length;--i>=0;)r[i]===t&&r.splice(i,1)},n.push=function(){var e,n=arguments;arguments.length>1&&i({type:"beforemulti"});for(var o=0,l=arguments.length;o<l;o++)e=t.length,t.push(n[o]),r(e),i({type:"itemadded",index:e,item:n[o]});return arguments.length>1&&i({type:"aftermulti"}),t.length},n.pop=function(){if(t.length>-1){var e=t.length-1,r=t.pop();return delete n[e],i({type:"itemremoved",index:e,item:r}),r}},n.unshift=function(){for(var e=arguments,n=0,o=arguments.length;n<o;n++)t.splice(n,0,e[n]),r(t.length-1),i({type:"itemadded",index:n,item:e[n]});for(;n<t.length;n++)i({type:"itemset",index:n,item:t[n]});return t.length},n.shift=function(){if(t.length>-1){var e=t.shift();return delete n[t.length],i({type:"itemremoved",index:0,item:e}),e}},n.splice=function(e,o){var l,u=arguments,s=[];for(e=null==e?0:e<0?t.length+e:e,o=null==o?t.length-e:o>0?o:0;o--;)l=t.splice(e,1)[0],s.push(l),delete n[t.length],i({type:"itemremoved",index:e+s.length-1,item:l});for(var a=2,f=arguments.length;a<f;a++)t.splice(e,0,u[a]),r(t.length-1),i({type:"itemadded",index:e,item:u[a]}),e++;return s},Object.defineProperty(n,"length",{configurable:!1,enumerable:!1,get:function(){return t.length},set:function(e){var r=Number(e),i=t.length;if(!(r%1==0&&r>=0))throw new RangeError("Invalid array length");return r<i?n.splice(r):r>i&&n.push.apply(n,new Array(r-i)),t.length=r,e}}),Object.defineProperty(n,"innerArray",{configurable:!1,enumerable:!1,get:function(){return t},set:function(e){t=e;for(var n=0;n<e.length;n++)r(n)}}),Object.getOwnPropertyNames(Array.prototype).forEach(function(e){e in n||Object.defineProperty(n,e,{configurable:!1,enumerable:!1,writable:!1,value:Array.prototype[e]})}),n.setEventsFrom=function(e){n.on=e.on,n.off=e.off,n._handlers=e._handlers},n.toJSON=function(){return t},Array.isArray(e)&&n.push.apply(n,e)}var n,t,r=function(n){var t=function(n){if(void 0===n)return t.$val;if(Array.isArray(n))(n=new e(n.slice(0))).setEventsFrom(t.$val);else if(n&&n.hasOwnProperty("innerArray")){var r=new e(n.innerArray.slice(0));r.setEventsFrom(n),n=r}var i=t.bc_depends;if(i.length)for(var o=0;o<i.length;o++)i[o].beforeCompute(n,t.$val,t);if(t.$val=n,(i=t.c_depends).length)for(o=0;o<i.length;o++)i[o](i[o].compute(n))};return t.$val=n,t.bc_depends=[],t.c_depends=[],t.toString=t.toJSON=function(){return t.$val.toString()},t},i=function(e){for(var n=[],t=arguments.length-1;t-- >0;)n[t]=arguments[t+1];var i=r(void 0);i.compute=e;for(var o=0;o<n.length;o++)n[o].c_depends.push(i);return i},o=function(e){for(var n=[],t=arguments.length-1;t-- >0;)n[t]=arguments[t+1];var i=r(void 0);i.beforeCompute=e;for(var o=0;o<n.length;o++)n[o].bc_depends.push(i);return i},l=function(e,n,t){var r=typeof t;"function"===r?t(e):("object"!==r&&(t=document.createTextNode(t)),e.insertBefore(t,e.children[n]))},u=function(e,n,t,r){var i=null;e.$val.on("beforemulti",function(){n.parentNode&&(i={parent:n,next:n.nextElementSibling},n=document.createDocumentFragment())}),e.$val.on("aftermulti",function(){i&&(i.parent.insertBefore(n,i.next),n=i.parent)}),e.$val.on("itemadded",function(e){l(n,e.index,t(e.item,e.index))}),e.$val.on("itemset",function(e){n.replaceChild(t(e.item,e.index),n.children.item(e.index))}),e.$val.on("itemremoved",function(e){n.removeChild(n.children.item(e.index))});var u=void 0;o(function(i){if(r)void 0===u&&i&&i.length>0&&(u=document.createDocumentFragment()),function(e,n,r,i,o,l,u){if(0!==r.length){if(n.length>r.length)for(var s,a=n.length,f=void 0!==u?u.previousSibling:e.lastChild;a>r.length;)s=f.previousSibling,e.removeChild(f),f=s,a--;var d=e.firstChild;d===u&&(d=void 0);for(var c=0,h=void 0,p=d,v=u?1:0;c<r.length;c++)h=r[c],p?o(h,n[c]):(p=t(h),v?e.insertBefore(p,u):e.appendChild(p)),(p=p.nextSibling)===u&&(p=null)}else if(void 0!==u){var b,m=e.firstChild;for(void 0===u&&(u=null);m!==u;)b=m.nextSibling,e.removeChild(m),m=b}else e.textContent=""}(u||n,e.$val.innerArray,i||[],0,function(e,n){for(var t in e)n[t].hasOwnProperty("$val")&&(e[t].c_depends=n[t].c_depends,e[t].bc_depends=n[t].bc_depends,n[t](e[t]()))}),u&&(n.appendChild(u),u=null);else{var o=document.createDocumentFragment();n.textContent="";for(var l=0;l<i.length;l++)o.appendChild(t(i[l]));n.appendChild(o)}},e)},s=function(){return"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof module?module:Function("return this")()},a={id:!0,nodeValue:!0,textContent:!0,className:!0,innerHTML:!0,innerText:!0,tabIndex:!0,value:!0},f=!1,d=document.createElement("template"),c=function(e,n,t){for(var r=n;r>=0;r--){var i=e[r],o=i.lastIndexOf("<");if(-1!==o){e[r]=i.substr(0,o)+t+i.substr(o);break}}},h=function(e,n){var t=[];!function(e,n){for(var t=document.createTreeWalker(e,NodeFilter.SHOW_COMMENT,{acceptNode:function(e){return e.nodeValue.trim().startsWith("cmt_")?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_REJECT}},!1);t.nextNode();)n.push(t.currentNode)}(e,t);for(var r=function(e){var r=t[e],o=r.nodeValue,l=null,u=null,s=o.indexOf("_")+1,f=o.indexOf("_",s),d=parseInt(o.substr(s,f-s));s=o.indexOf("_",f)+1,-1===(f=o.indexOf("_",s))&&(f=o.indexOf(" ",s));var c=parseInt(o.substr(s,f-s)),h=n[c];if(3&d){if(1===d){if(u="textContent",l=document.createTextNode(h.$val),r.parentElement.insertBefore(l,r.nextSibling),!h.hasOwnProperty("$val")&&Array.isArray(h))for(var p=0;p<h.length;p++)r.parentElement.appendChild(h[p])}else 2===d&&(u=o.substr(f+1,o.length-f-2),l=r.nextElementSibling);if(u.startsWith("on"))l.addEventListener(u.substr(2),h);else if(h.hasOwnProperty("$val"))a[u]?(i(function(e){l[u]=e},h).name$="["+u+"]",l[u]=h()):(i(function(e){l.setAttribute(u,e)},h).name$="attr("+u+")",l.setAttribute(u,h()));else{if("function"==typeof h){var v=h(l);void 0!==v&&(h=v)}a[u]?l[u]=h:l.setAttribute(u,h)}}else 4===d?h(r):8===d&&r.parentElement.insertBefore(h,r.nextSibling)},o=0;o<t.length;o++)r(o)},p=("function"==typeof(t=s().Symbol)?t.observable?n=t.observable:(n=t("observable"),t.observable=n):n="@@observable",n),v=function(e){this.isUnsubscribed=!1,this.handlers=null,this._unsubscribe=null,this.handlers=e,this.isUnsubscribed=!1};v.prototype.next=function(e){this.handlers.next&&!this.isUnsubscribed&&this.handlers.next(e)},v.prototype.error=function(e){this.isUnsubscribed||(this.handlers.error&&this.handlers.error(e),this.unsubscribe())},v.prototype.complete=function(){this.isUnsubscribed||(this.handlers.complete&&this.handlers.complete(),this.unsubscribe())},v.prototype.unsubscribe=function(){this.isUnsubscribed=!0,this._unsubscribe&&this._unsubscribe()};var b=function(e){this._subscribe=null,this._subscribe=e};b.prototype.subscribe=function(e){var n=new v(e);return n._unsubscribe=this._subscribe(n),{unsubscribe:function(){n.unsubscribe()}}},b.prototype[p]=function(){return this},exports.fidan={array:function(n){var t=r(new e(n));return t.toJSON=function(){return t.$val.innerArray},t},value:r,compute:i,beforeCompute:o,destroy:function(e){delete e.compute,delete e.c_depends},insertToDom:l,arrayMap:u,setDefaults:function(e,n){for(var t in n)void 0===e[t]&&(e[t]=n[t])},mapProperty:function(e,n,t){var i=Object.getOwnPropertyDescriptor(e,n);i.configurable?Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:function(){return t.$val},set:t}):i.set.depends.push(r(function(){t(e[n])}))},jsRoot:s,html:function(){for(var e=[],n=arguments.length;n--;)e[n]=arguments[n];for(var t=e[0].slice(),r=e.slice(1),i=null,o=0,l=0;l<t.length;l++){var u=t[l],s=r[l];if(void 0===s)break;var a=s.hasOwnProperty("$val");a&&(void 0===s.$indexes&&(s.$indexes=[]),s.$indexes.push(l)),u.endsWith('="')?(o=u.lastIndexOf(" ")+1,i=u.substr(o,u.length-o-2),c(t,l,"\x3c!-- cmt_2_"+l+"_"+i+" --\x3e")):t[l]=u+"\x3c!-- cmt_"+("function"!=typeof s||a?"object"==typeof s?8:1:4)+"_"+l+" --\x3e"}(d=d.cloneNode(!1)).innerHTML=t.join("");var p=d.content;return p.$params=r,f||h(p,r),p},htmlArrayMap:function(e,n,t){return(t=Object.assign({useCloneNode:!1,reuseMode:!1},t)).useCloneNode?function(r){var i=null,o=null,l=[];u(e,r.parentElement,function(e){var t=null;if(null===i){for(var r in f=!0,t=n(e),f=!1,o=t.$params,e){var u=e[r].$indexes;if(u)for(var s=0;s<u.length;s++)l.push(u[s],r)}i=t.cloneNode(!0)}else t=i.cloneNode(!0);for(s=0;s<l.length;s+=2)o[l[s]]=e[l[s+1]];return h(t,o),t},t.reuseMode)}:function(t){u(e,t.parentElement,n)}},toObservable:function(e){return new b(function(n){var t=r(function(){n.next(e.$val)});e.depends.push(t)})}};
//# sourceMappingURL=index.js.map
