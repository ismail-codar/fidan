{"version":3,"file":"index.js","sources":["../src/evented-array.ts","../src/f.ts","../src/dom.ts","../src/html.ts","../src/util.ts","../src/context.ts","../src/dom-tree.ts","../src/observable.ts","../src/index.ts"],"sourcesContent":["export type ArrayMutableMethods =\n  | \"copyWithin\" // TODO ArrayMutableMethods copyWithin\n  | \"fill\" // TODO ArrayMutableMethods fill\n  | \"pop\"\n  | \"push\"\n  | \"reverse\" // TODO ArrayMutableMethods reverse\n  | \"shift\"\n  | \"sort\" // TODO ArrayMutableMethods sort\n  | \"splice\"\n  | \"unshift\";\n\n// TODO concat vs..\n\nexport function EventedArray(items) {\n  var _self = this,\n    _array = [],\n    _handlers = {\n      itemadded: [],\n      itemremoved: [],\n      itemset: [],\n      beforemulti: [],\n      aftermulti: []\n    };\n\n  function defineIndexProperty(index) {\n    if (!(index in _self)) {\n      Object.defineProperty(_self, index, {\n        configurable: true,\n        enumerable: true,\n        get: function() {\n          return _array[index];\n        },\n        set: function(v) {\n          _array[index] = v;\n          raiseEvent({\n            type: \"itemset\",\n            index: index,\n            item: v\n          });\n        }\n      });\n    }\n  }\n\n  function raiseEvent(event) {\n    _handlers[event.type].forEach(function(h) {\n      h.call(_self, event);\n    });\n  }\n\n  _self.on = function(eventName, handler) {\n    _handlers[eventName].push(handler);\n  };\n\n  _self.off = function(eventName, handler) {\n    var h = _handlers[eventName];\n    var ln = h.length;\n    while (--ln >= 0) {\n      if (h[ln] === handler) {\n        h.splice(ln, 1);\n      }\n    }\n  };\n\n  _self.push = function() {\n    var index;\n    arguments.length > 1 &&\n      raiseEvent({\n        type: \"beforemulti\"\n      });\n    for (var i = 0, ln = arguments.length; i < ln; i++) {\n      index = _array.length;\n      _array.push(arguments[i]);\n      defineIndexProperty(index);\n      raiseEvent({\n        type: \"itemadded\",\n        index: index,\n        item: arguments[i]\n      });\n    }\n    arguments.length > 1 &&\n      raiseEvent({\n        type: \"aftermulti\"\n      });\n    return _array.length;\n  };\n\n  _self.pop = function() {\n    if (_array.length > -1) {\n      var index = _array.length - 1,\n        item = _array.pop();\n      delete _self[index];\n      raiseEvent({\n        type: \"itemremoved\",\n        index: index,\n        item: item\n      });\n      return item;\n    }\n  };\n\n  _self.unshift = function() {\n    for (var i = 0, ln = arguments.length; i < ln; i++) {\n      _array.splice(i, 0, arguments[i]);\n      defineIndexProperty(_array.length - 1);\n      raiseEvent({\n        type: \"itemadded\",\n        index: i,\n        item: arguments[i]\n      });\n    }\n    for (; i < _array.length; i++) {\n      raiseEvent({\n        type: \"itemset\",\n        index: i,\n        item: _array[i]\n      });\n    }\n    return _array.length;\n  };\n\n  _self.shift = function() {\n    if (_array.length > -1) {\n      var item = _array.shift();\n      delete _self[_array.length];\n      raiseEvent({\n        type: \"itemremoved\",\n        index: 0,\n        item: item\n      });\n      return item;\n    }\n  };\n\n  _self.splice = function(index, howMany /*, element1, element2, ... */) {\n    var removed = [],\n      item,\n      pos;\n\n    index = index == null ? 0 : index < 0 ? _array.length + index : index;\n\n    howMany =\n      howMany == null ? _array.length - index : howMany > 0 ? howMany : 0;\n\n    while (howMany--) {\n      item = _array.splice(index, 1)[0];\n      removed.push(item);\n      delete _self[_array.length];\n      raiseEvent({\n        type: \"itemremoved\",\n        index: index + removed.length - 1,\n        item: item\n      });\n    }\n\n    for (var i = 2, ln = arguments.length; i < ln; i++) {\n      _array.splice(index, 0, arguments[i]);\n      defineIndexProperty(_array.length - 1);\n      raiseEvent({\n        type: \"itemadded\",\n        index: index,\n        item: arguments[i]\n      });\n      index++;\n    }\n\n    return removed;\n  };\n\n  Object.defineProperty(_self, \"length\", {\n    configurable: false,\n    enumerable: false,\n    get: function() {\n      return _array.length;\n    },\n    set: function(value) {\n      var n = Number(value);\n      var length = _array.length;\n      if (n % 1 === 0 && n >= 0) {\n        if (n < length) {\n          _self.splice(n);\n        } else if (n > length) {\n          _self.push.apply(_self, new Array(n - length));\n        }\n      } else {\n        throw new RangeError(\"Invalid array length\");\n      }\n      _array.length = n;\n      return value;\n    }\n  });\n\n  Object.defineProperty(_self, \"innerArray\", {\n    configurable: false,\n    enumerable: false,\n    get: function() {\n      return _array;\n    },\n    set: function(v) {\n      _array = v;\n      for (var i = 0; i < v.length; i++) {\n        defineIndexProperty(i);\n      }\n    }\n  });\n\n  Object.getOwnPropertyNames(Array.prototype).forEach(function(name) {\n    if (!(name in _self)) {\n      Object.defineProperty(_self, name, {\n        configurable: false,\n        enumerable: false,\n        writable: false,\n        value: Array.prototype[name]\n      });\n    }\n  });\n\n  _self.toJSON = () => {\n    return _array;\n  };\n\n  if (Array.isArray(items)) {\n    _self.push.apply(_self, items);\n  }\n}\n","import { EventedArray } from \"./evented-array\";\r\n\r\nexport interface FidanValue<T> {\r\n  (val: T): void;\r\n  readonly $val: T;\r\n  freezed: boolean;\r\n}\r\n\r\nexport type FidanArrayEventType = \"itemadded\" | \"itemset\" | \"itemremoved\";\r\n\r\nexport const value = <T>(value?: T, freezed?: boolean): FidanValue<T> => {\r\n  if (value && value[\"$val\"] != undefined)\r\n    throw \"Fidan: Higher ordered signals is not supported.\";\r\n  const innerFn: any = (val?) => {\r\n    if (val === undefined) {\r\n      return innerFn[\"$val\"];\r\n    } else if (Array.isArray(val)) {\r\n      innerFn[\"$val\"].innerArray = val;\r\n    } else innerFn[\"$val\"] = val;\r\n    const depends = innerFn[\"depends\"];\r\n    if (depends.length)\r\n      for (var i = 0; i < depends.length; i++)\r\n        !depends[i][\"freezed\"] && depends[i](depends[i].compute());\r\n  };\r\n  innerFn[\"$val\"] = value;\r\n  innerFn[\"freezed\"] = freezed;\r\n\r\n  innerFn[\"depends\"] = [];\r\n  innerFn.toString = innerFn.toJSON = () => innerFn[\"$val\"].toString();\r\n  return innerFn;\r\n};\r\n\r\nexport const array = <T>(\r\n  items: T[]\r\n): {\r\n  on?: (\r\n    type: FidanArrayEventType,\r\n    callback: (e: { item: T; index: number }) => void\r\n  ) => void;\r\n  removeEventListener?: (type: FidanArrayEventType) => void;\r\n  $val: T[];\r\n} & FidanValue<T[]> => {\r\n  const arr = value(new EventedArray(items)) as any;\r\n  arr.on = arr.$val.on;\r\n  arr.off = arr.$val.off;\r\n  arr.toJSON = () => arr.$val.innerArray;\r\n\r\n  return arr;\r\n};\r\n\r\nexport const on = (\r\n  arr: any[],\r\n  type: FidanArrayEventType,\r\n  callback: (e: { item: any; index: number }) => void\r\n) => {\r\n  arr[\"$val\"].on(type, callback);\r\n};\r\n\r\nexport const off = (\r\n  arr: any[],\r\n  type: FidanArrayEventType,\r\n  callback: (e: { item: any; index: number }) => void\r\n) => {\r\n  arr[\"$val\"].off(type, callback);\r\n};\r\n\r\nexport const compute = (fn: () => void, ...args: any[]) => {\r\n  var compute = value();\r\n  compute[\"compute\"] = fn;\r\n  for (var i = 0; i < args.length; i++) args[i][\"depends\"].push(compute);\r\n  fn();\r\n};\r\n\r\nexport const initCompute = (fn: () => any, ...args: any[]) => {\r\n  const cValue = value(fn());\r\n  compute(() => {\r\n    cValue(fn());\r\n  }, ...args);\r\n  return cValue;\r\n};\r\n\r\n// TODO typedCompute, typedValue ...\r\nexport const computeReturn = <T>(fn: () => T, ...args: any[]): T =>\r\n  initCompute(fn, ...args) as any;\r\n\r\nexport const setCompute = (prev: any, fn: () => void, ...args: any[]) => {\r\n  destroy(prev);\r\n  return initCompute(prev, fn, ...args);\r\n};\r\n\r\nexport const destroy = (item: any) => {\r\n  delete item[\"compute\"];\r\n  delete item[\"depends\"];\r\n};\r\n","import { FidanValue } from \"./f\";\nimport { EventedArray } from \"./evented-array\";\nimport { compute } from \"./f\";\n\nexport const insertToDom = (parentElement, index, itemElement) => {\n  const typeOf = typeof itemElement;\n  if (typeOf === \"function\") {\n    itemElement(parentElement);\n  } else {\n    if (typeOf !== \"object\") {\n      itemElement = document.createTextNode(itemElement);\n    }\n    parentElement.insertBefore(itemElement, parentElement.children[index]);\n  }\n};\n\nexport const arrayMap = (\n  arr: FidanValue<any[]>,\n  parentDom: Node & ParentNode,\n  renderReturn: (item: any, idx?: number, isInsert?: boolean) => void\n) => {\n  const oArr =\n    arr.$val instanceof EventedArray ? arr.$val : new EventedArray(arr.$val);\n  const arrVal = arr.$val;\n\n  let parentRef: { parent: Node & ParentNode; next: Node } = null;\n  oArr.on(\"beforemulti\", function() {\n    if (parentDom.parentNode) {\n      parentRef = {\n        parent: parentDom,\n        next: (parentDom as Element).nextElementSibling\n      };\n      parentDom = document.createDocumentFragment();\n    }\n  });\n  oArr.on(\"aftermulti\", function() {\n    if (parentRef) {\n      parentRef.parent.insertBefore(parentDom, parentRef.next);\n      parentDom = parentRef.parent;\n    }\n  });\n\n  oArr.on(\"itemadded\", function(e) {\n    insertToDom(parentDom, e.index, renderReturn(e.item, e.index));\n  });\n\n  oArr.on(\"itemset\", function(e) {\n    parentDom.replaceChild(\n      renderReturn(e.item, e.index) as any,\n      parentDom.children.item(e.index)\n    );\n  });\n\n  oArr.on(\"itemremoved\", function(e) {\n    parentDom.removeChild(parentDom.children.item(e.index));\n  });\n  arr(oArr);\n\n  const arrayComputeRenderAll = () => {\n    if (arrVal.length === 0) parentDom.textContent = \"\";\n    else {\n      let itemElement = null;\n      const parentFragment = document.createDocumentFragment();\n      parentDom.textContent = \"\";\n      for (var i = parentDom.childElementCount; i < arrVal.length; i++) {\n        itemElement = renderReturn(arrVal[i], i);\n        if (typeof itemElement !== \"object\") {\n          itemElement = document.createTextNode(itemElement);\n        }\n        parentFragment.insertBefore(itemElement, parentDom.children[i]);\n      }\n      parentDom.appendChild(parentFragment);\n    }\n  };\n\n  compute(arrayComputeRenderAll, arr);\n};\n","import { FidanValue, array, compute } from \"./f\";\nimport { arrayMap } from \"./dom\";\n\nconst COMMENT_TEXT = 1;\nconst COMMENT_DOM = 2;\nconst COMMENT_FN = 4;\nconst COMMENT_HTM = 8;\nconst COMMENT_TEXT_OR_DOM = COMMENT_TEXT | COMMENT_DOM;\n\nconst htmlProps = {\n  id: true,\n  nodeValue: true,\n  textContent: true,\n  className: true,\n  innerHTML: true,\n  innerText: true,\n  tabIndex: true,\n  value: true\n};\n\nlet _templateMode = false; // TODO kaldırılacak yerine başka bir yöntem geliştirilecek\nlet template = document.createElement(\"template\");\n\nconst putCommentToTagStart = (\n  htm: string[],\n  index: number,\n  comment: string\n) => {\n  for (var i = index; i >= 0; i--) {\n    let item = htm[i];\n    let p = item.lastIndexOf(\"<\");\n    if (p !== -1) {\n      htm[i] = item.substr(0, p) + comment + item.substr(p);\n      // htm[i] =\n      //   item.substr(0, p) + comment + item.substr(p, item.lastIndexOf(\" \") - p);\n      // if (htm[index + 1].substr(0, 1) === '\"') {\n      //   htm[index + 1] = htm[index + 1].substr(1);\n      // }\n      break;\n    }\n  }\n};\n\nexport const html = (...args) => {\n  const htm: string[] = args[0].slice();\n  const params = args.slice(1);\n  let attributeName: string = null;\n  let i = 0;\n\n  for (var index = 0; index < htm.length; index++) {\n    let item = htm[index];\n    const param = params[index];\n    if (param === undefined) {\n      break;\n    }\n    const isDynamic = param.hasOwnProperty(\"$val\");\n    if (isDynamic) {\n      if (param[\"$indexes\"] === undefined) {\n        param[\"$indexes\"] = [];\n      }\n      param[\"$indexes\"].push(index);\n    }\n    if (item.endsWith('=\"')) {\n      i = item.lastIndexOf(\" \") + 1;\n      attributeName = item.substr(i, item.length - i - 2);\n      putCommentToTagStart(\n        htm,\n        index,\n        `<!-- cmt_${COMMENT_DOM}_${index}_${attributeName} -->`\n      );\n    } else {\n      let commentType =\n        typeof param === \"function\" && !isDynamic\n          ? COMMENT_FN\n          : typeof param === \"object\"\n          ? COMMENT_HTM\n          : COMMENT_TEXT;\n      htm[index] = item + `<!-- cmt_${commentType}_${index} -->`;\n    }\n  }\n  template = template.cloneNode(false) as HTMLTemplateElement;\n  template.innerHTML = htm.join(\"\");\n  const element = template.content;\n  element[\"$params\"] = params;\n  if (!_templateMode) {\n    updateNodesByCommentNodes(element, params);\n  }\n  return element;\n};\n\nconst walkForCommentNodes = (element, commentNodes) => {\n  var treeWalker = document.createTreeWalker(\n    element,\n    NodeFilter.SHOW_COMMENT,\n    {\n      acceptNode: function(node) {\n        var nodeValue = node.nodeValue.trim();\n        return nodeValue.startsWith(\"cmt_\")\n          ? NodeFilter.FILTER_ACCEPT\n          : NodeFilter.FILTER_REJECT;\n      }\n    },\n    false\n  );\n\n  while (treeWalker.nextNode()) {\n    commentNodes.push(treeWalker.currentNode);\n  }\n};\n\nconst updateNodesByCommentNodes = (element: Node, params: any[]) => {\n  var commentNodes = [];\n  walkForCommentNodes(element, commentNodes);\n\n  for (var i = 0; i < commentNodes.length; i++) {\n    const commentNode = commentNodes[i];\n    var commentValue = commentNode.nodeValue;\n    let element = null;\n    let attributeName: string = null;\n\n    let i1 = commentValue.indexOf(\"_\") + 1;\n    var i2 = commentValue.indexOf(\"_\", i1);\n    const commentType = parseInt(commentValue.substr(i1, i2 - i1));\n    i1 = commentValue.indexOf(\"_\", i2) + 1;\n    i2 = commentValue.indexOf(\"_\", i1);\n    if (i2 === -1) {\n      i2 = commentValue.indexOf(\" \", i1);\n    }\n    let paramIndex = parseInt(commentValue.substr(i1, i2 - i1));\n    let param = params[paramIndex];\n\n    if (commentType & COMMENT_TEXT_OR_DOM) {\n      if (commentType === COMMENT_TEXT) {\n        attributeName = \"textContent\";\n        element = document.createTextNode(param.$val);\n        commentNode.parentElement.insertBefore(\n          element,\n          commentNode.nextSibling\n        );\n        if (!param.hasOwnProperty(\"$val\")) {\n          if (Array.isArray(param)) {\n            for (var p = 0; p < param.length; p++) {\n              commentNode.parentElement.appendChild(param[p]);\n            }\n          }\n        }\n      } else if (commentType === COMMENT_DOM) {\n        attributeName = commentValue.substr(\n          i2 + 1,\n          commentValue.length - i2 - 2\n        );\n        element = commentNode.nextElementSibling;\n      }\n      if (attributeName.startsWith(\"on\")) {\n        (element as Element).addEventListener(attributeName.substr(2), param);\n      } else if (param.hasOwnProperty(\"$val\")) {\n        if (htmlProps[attributeName]) {\n          compute(() => {\n            element[attributeName] = param.$val;\n          }, param);\n        } else {\n          compute(() => {\n            element.setAttribute(attributeName, param.$val);\n          }, param);\n        }\n      } else {\n        if (htmlProps[attributeName]) {\n          element[attributeName] = param;\n        } else {\n          element.setAttribute(attributeName, param);\n        }\n      }\n    } else if (commentType === COMMENT_FN) {\n      param(commentNode);\n    } else if (commentType === COMMENT_HTM) {\n      commentNode.parentElement.insertBefore(param, commentNode.nextSibling);\n    }\n  }\n};\n\nexport const htmlArrayMap = (\n  arr: any[] | FidanValue<any[]>,\n  renderCallback: (data: number) => any,\n  useCloneNode?: boolean\n) => {\n  if (Array.isArray(arr)) {\n    const oArray = array(arr);\n    [\n      \"copyWithin\",\n      \"fill\",\n      \"pop\",\n      \"push\",\n      \"reverse\",\n      \"shift\",\n      \"sort\",\n      \"splice\",\n      \"unshift\"\n    ].forEach(method => (arr[method] = oArray.$val[method]));\n    arr = oArray;\n  }\n  if (useCloneNode) {\n    return (commentNode: Node) => {\n      const element = commentNode.parentElement;\n      let clonedNode = null;\n      let params = null;\n      let dataParamIndexes = [];\n      const arrayMapFn = (data, rowIndex) => {\n        let renderNode = null;\n        if (clonedNode === null) {\n          _templateMode = true;\n          renderNode = renderCallback(data);\n          _templateMode = false;\n          params = renderNode[\"$params\"];\n          for (var key in data) {\n            const indexes = data[key][\"$indexes\"];\n            for (var i = 0; i < indexes.length; i++) {\n              dataParamIndexes.push(indexes[i], key);\n            }\n          }\n          clonedNode = renderNode.cloneNode(true);\n        } else {\n          renderNode = clonedNode.cloneNode(true);\n        }\n        for (var i = 0; i < dataParamIndexes.length; i += 2) {\n          params[dataParamIndexes[i]] = data[dataParamIndexes[i + 1]];\n        }\n        updateNodesByCommentNodes(renderNode, params);\n        return renderNode;\n      };\n      arrayMap(arr as any, element, arrayMapFn);\n    };\n  } else {\n    return function(commentNode) {\n      var element = commentNode.parentElement;\n      arrayMap(arr as any, element, renderCallback);\n    };\n  }\n};\n","import { value } from \"./f\";\n\nexport const setDefaults = <T>(\n  obj: T,\n  defaults: { [key in keyof T]?: any }\n) => {\n  for (var key in defaults) {\n    if (obj[key] === undefined) obj[key] = defaults[key];\n  }\n};\n\nexport const mapProperty = (obj: Object, propertyKey: string, value$: any) => {\n  const descr = Object.getOwnPropertyDescriptor(obj, propertyKey);\n  if (descr.configurable)\n    Object.defineProperty(obj, propertyKey, {\n      configurable: false,\n      enumerable: true,\n      get: () => {\n        return value$.$val;\n      },\n      set: value$\n    });\n  else {\n    descr.set[\"depends\"].push(\n      value(() => {\n        value$(obj[propertyKey]);\n      })\n    );\n  }\n};\n\nexport const jsRoot = () => {\n  let root;\n\n  if (typeof self !== \"undefined\") {\n    root = self;\n  } else if (typeof window !== \"undefined\") {\n    root = window;\n  } else if (typeof global !== \"undefined\") {\n    root = global;\n  } else if (typeof module !== \"undefined\") {\n    root = module;\n  } else {\n    root = Function(\"return this\")();\n  }\n  return root;\n};\n","const activeContextKeys = [];\nconst appContext: { [key: string]: any[] } = {};\n\nexport const startContext = (key: string, value: any) => {\n  if (!appContext[key]) appContext[key] = [];\n  appContext[key].push(value);\n  activeContextKeys.push(key);\n};\n\nexport const getContextValue = (key: string, componentProps: any) => {\n  if (componentProps && componentProps[\"$context\"][key])\n    return componentProps[\"$context\"][key];\n  if (appContext[key]) return appContext[key][appContext[key].length - 1];\n};\n\nexport const injectContexts = (componentProps: any) => {\n  if (!componentProps[\"$context\"])\n    Object.defineProperty(componentProps, \"$context\", {\n      configurable: false,\n      enumerable: false,\n      value: {}\n    });\n  let key = null;\n  for (var i = 0; i < activeContextKeys.length; i++) {\n    key = activeContextKeys[i];\n    componentProps[\"$context\"][key] =\n      appContext[key][appContext[key].length - 1];\n  }\n};\n\nexport const endContext = (key: string) => {\n  appContext[key].pop();\n  activeContextKeys.pop();\n};\n\nexport const activateContext = context => {\n  for (var key in context) startContext(key, context[key]);\n};\n\nexport const deactivateContext = context => {\n  for (var key in context) endContext(key);\n};\n\nexport const Context = (props: { key: string; value: any }) => null;\n","import { injectContexts, activateContext, deactivateContext } from \"./context\";\r\n\r\nvar jsxEventProperty = /^on[A-Z]/;\r\nconst svgNS = \"http://www.w3.org/2000/svg\";\r\nexport const Fragment = Symbol(\"fjsx.Fragment\");\r\n\r\nexport const conditionalElement = (\r\n  parentElement,\r\n  oldElement,\r\n  newElementFn: () => any\r\n) => {\r\n  parentElement[\"$props\"] &&\r\n    activateContext(parentElement[\"$props\"][\"$context\"]);\r\n  let newElement = newElementFn();\r\n  parentElement[\"$props\"] &&\r\n    deactivateContext(parentElement[\"$props\"][\"$context\"]);\r\n  if (newElement instanceof Node === false)\r\n    newElement = document.createTextNode(newElement || \"\");\r\n  if (oldElement) parentElement.replaceChild(newElement, oldElement);\r\n  else parentElement.appendChild(newElement);\r\n  return newElement;\r\n};\r\n\r\nexport const setElementAttributes = (\r\n  element: Element,\r\n  attributes,\r\n  forceSetAttr?: boolean\r\n) => {\r\n  let attribute = null;\r\n  for (var attributeName in attributes) {\r\n    attribute = attributes[attributeName];\r\n    if (attribute != undefined) {\r\n      if (attribute instanceof Function) {\r\n        if (jsxEventProperty.test(attributeName)) {\r\n          attributeName = attributeName.toLowerCase();\r\n          element[attributeName] = attribute;\r\n        } else attribute(element);\r\n      } else if (attribute instanceof Object) {\r\n        if (Array.isArray(attribute)) {\r\n          addChildElements(element, attribute);\r\n        } else {\r\n          for (var key in attribute) {\r\n            if (typeof attribute[key] === \"function\") attribute[key](element);\r\n            else element[attributeName][key] = attribute[key]; // style like\r\n          }\r\n        }\r\n      } else {\r\n        if (forceSetAttr || attributeName.indexOf(\"-\") !== -1)\r\n          element.setAttribute(attributeName, attribute);\r\n        else element[attributeName] = attribute;\r\n      }\r\n    }\r\n  }\r\n};\r\n\r\nexport const createElement = (\r\n  tagName: string | Function | Symbol,\r\n  attributes: { [key: string]: any },\r\n  ...childs: any[]\r\n) => {\r\n  let element = null;\r\n  if (tagName instanceof Function) {\r\n    if (attributes === null) attributes = {};\r\n    if (childs && childs.length) attributes[\"children\"] = childs;\r\n    injectContexts(attributes);\r\n    element = (tagName as any)(attributes);\r\n    if (element) element[\"$props\"] = attributes;\r\n  } else {\r\n    if (tagName === Fragment) {\r\n      element = document.createDocumentFragment();\r\n    } else {\r\n      element = document.createElement(tagName as any);\r\n      attributes &&\r\n        setElementAttributes(\r\n          element,\r\n          attributes,\r\n          (tagName as string).indexOf(\"-\") !== -1\r\n        );\r\n    }\r\n    element[\"$props\"] = attributes;\r\n    childs && childs.length && addChildElements(element, childs);\r\n  }\r\n  return element;\r\n};\r\n\r\nexport const createSvgElement = (\r\n  tagName: string,\r\n  attributes: { [key: string]: any },\r\n  ...childs: any[]\r\n) => {\r\n  let element = document.createElementNS(svgNS, tagName);\r\n  if (attributes) {\r\n    if (attributes.className) {\r\n      // TODO compile time\r\n      attributes.class = attributes.className;\r\n      delete attributes.className;\r\n    }\r\n    setElementAttributes(element, attributes, true);\r\n  }\r\n  element[\"$props\"] = attributes;\r\n  childs && childs.length && addChildElements(element, childs);\r\n  return element;\r\n};\r\n\r\nexport const addChildElements = (element, childs) => {\r\n  let props = null;\r\n  for (var i = 0; i < childs.length; i++) {\r\n    if (Array.isArray(childs[i])) addChildElements(element, childs[i]);\r\n    else if (childs[i] instanceof Function) childs[i](element);\r\n    else {\r\n      if (childs[i] != null) {\r\n        props = childs[i][\"$props\"];\r\n        element.appendChild(\r\n          childs[i] instanceof Node\r\n            ? childs[i]\r\n            : document.createTextNode(childs[i])\r\n        );\r\n        props && props.didMount && props.didMount(element, childs[i]);\r\n      }\r\n    }\r\n  }\r\n};\r\n\r\nexport const createTextNode = parent => {\r\n  return parent.appendChild(document.createTextNode(\"\"));\r\n};\r\n\r\nexport const cloneElement = (element: Element, attributes: any) => {\r\n  element = element.cloneNode(true) as Element;\r\n  attributes && setElementAttributes(element, attributes, false);\r\n  return element;\r\n};\r\n","import { FidanValue, value } from \"./f\";\nimport { jsRoot } from \"./util\";\n\nfunction symbolObservablePonyfill(root) {\n  let result;\n  const Symbol = root.Symbol;\n\n  if (typeof Symbol === \"function\") {\n    if (Symbol.observable) {\n      result = Symbol.observable;\n    } else {\n      result = Symbol(\"observable\");\n      Symbol.observable = result;\n    }\n  } else {\n    result = \"@@observable\";\n  }\n\n  return result;\n}\n\nconst $$symbolObservable = symbolObservablePonyfill(jsRoot());\n\nclass Observer {\n  isUnsubscribed = false;\n  handlers: Partial<Observer> = null;\n  _unsubscribe = null;\n  constructor(handlers: Partial<Observer>) {\n    this.handlers = handlers;\n    this.isUnsubscribed = false;\n  }\n\n  next(value) {\n    if (this.handlers.next && !this.isUnsubscribed) {\n      this.handlers.next(value);\n    }\n  }\n\n  error(error) {\n    if (!this.isUnsubscribed) {\n      if (this.handlers.error) {\n        this.handlers.error(error);\n      }\n\n      this.unsubscribe();\n    }\n  }\n\n  complete() {\n    if (!this.isUnsubscribed) {\n      if (this.handlers.complete) {\n        this.handlers.complete();\n      }\n\n      this.unsubscribe();\n    }\n  }\n\n  unsubscribe() {\n    this.isUnsubscribed = true;\n\n    if (this._unsubscribe) {\n      this._unsubscribe();\n    }\n  }\n}\n\nclass Observable {\n  _subscribe: (observer: Observer) => () => void = null;\n  constructor(subscribe) {\n    this._subscribe = subscribe;\n  }\n\n  subscribe(obs: Partial<Observer>) {\n    const observer = new Observer(obs);\n\n    observer._unsubscribe = this._subscribe(observer);\n\n    return {\n      unsubscribe() {\n        observer.unsubscribe();\n      }\n    };\n  }\n\n  [$$symbolObservable]() {\n    return this;\n  }\n}\n\nexport const toObservable = <T>(data: FidanValue<any>): T => {\n  return new Observable(observer => {\n    var compute = value(() => {\n      observer.next(data.$val);\n    });\n    data[\"depends\"].push(compute);\n  }) as any;\n};\n","/// <reference path=\"../types/JSX.d.ts\" />\nimport * as fidanObj from \"./libs\";\nexport const fidan = fidanObj;\nfidan[\"VERSION\"] = \"0.0.4\";\n"],"names":["EventedArray","items","_self","this","_array","_handlers","itemadded","itemremoved","itemset","beforemulti","aftermulti","defineIndexProperty","index","Object","defineProperty","configurable","enumerable","get","set","v","raiseEvent","type","item","event","forEach","h","call","on","eventName","handler","push","off","ln","length","splice","arguments","i","pop","unshift","shift","howMany","removed","value","n","Number","RangeError","apply","Array","getOwnPropertyNames","prototype","name","writable","toJSON","isArray","const","freezed","undefined","innerFn","val","innerArray","depends","compute","toString","array","arr","$val","fn","args","initCompute","cValue","destroy","insertToDom","parentElement","itemElement","typeOf","document","createTextNode","insertBefore","children","arrayMap","parentDom","renderReturn","oArr","arrVal","parentRef","parentNode","parent","next","nextElementSibling","createDocumentFragment","e","replaceChild","removeChild","textContent","parentFragment","childElementCount","appendChild","htmlProps","id","nodeValue","className","innerHTML","innerText","tabIndex","_templateMode","template","createElement","putCommentToTagStart","htm","comment","p","lastIndexOf","substr","updateNodesByCommentNodes","element","params","commentNodes","treeWalker","createTreeWalker","NodeFilter","SHOW_COMMENT","acceptNode","node","trim","startsWith","FILTER_ACCEPT","FILTER_REJECT","nextNode","currentNode","walkForCommentNodes","commentNode","commentValue","attributeName","i1","indexOf","i2","commentType","parseInt","paramIndex","param","COMMENT_TEXT","nextSibling","hasOwnProperty","addEventListener","setAttribute","jsRoot","self","window","global","module","Function","activeContextKeys","appContext","startContext","key","injectContexts","componentProps","endContext","activateContext","context","deactivateContext","jsxEventProperty","Fragment","Symbol","setElementAttributes","attributes","forceSetAttr","attribute","test","toLowerCase","addChildElements","childs","props","Node","didMount","$$symbolObservable","root","result","observable","symbolObservablePonyfill","Observer","constructor","handlers","isUnsubscribed","error","unsubscribe","complete","_unsubscribe","Observable","subscribe","_subscribe","obs","observer","fidan","callback","prev","slice","isDynamic","endsWith","cloneNode","join","content","renderCallback","useCloneNode","oArray","method","clonedNode","dataParamIndexes","data","rowIndex","renderNode","indexes","obj","defaults","propertyKey","value$","descr","getOwnPropertyDescriptor","oldElement","newElementFn","newElement","tagName","createElementNS","class"],"mappings":"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"}