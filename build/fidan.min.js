var fidan=function(e){function n(e){var n=this,t=[],r={itemadded:[],itemremoved:[],itemset:[],beforemulti:[],aftermulti:[]};function i(e){e in n||Object.defineProperty(n,e,{configurable:!0,enumerable:!0,get:function(){return t[e]},set:function(n){t[e]=n,o({type:"itemset",index:e,item:n})}})}function o(e){r[e.type].forEach(function(t){t.call(n,e)})}n.on=function(e,n){r[e].push(n)},n.off=function(e,n){for(var t=r[e],i=t.length;--i>=0;)t[i]===n&&t.splice(i,1)},n.push=function(){var e,n=arguments;arguments.length>1&&o({type:"beforemulti"});for(var r=0,a=arguments.length;r<a;r++)e=t.length,t.push(n[r]),i(e),o({type:"itemadded",index:e,item:n[r]});return arguments.length>1&&o({type:"aftermulti"}),t.length},n.pop=function(){if(t.length>-1){var e=t.length-1,r=t.pop();return delete n[e],o({type:"itemremoved",index:e,item:r}),r}},n.unshift=function(){for(var e=arguments,n=0,r=arguments.length;n<r;n++)t.splice(n,0,e[n]),i(t.length-1),o({type:"itemadded",index:n,item:e[n]});for(;n<t.length;n++)o({type:"itemset",index:n,item:t[n]});return t.length},n.shift=function(){if(t.length>-1){var e=t.shift();return delete n[t.length],o({type:"itemremoved",index:0,item:e}),e}},n.splice=function(e,r){var a,l=arguments,u=[];for(e=null==e?0:e<0?t.length+e:e,r=null==r?t.length-e:r>0?r:0;r--;)a=t.splice(e,1)[0],u.push(a),delete n[t.length],o({type:"itemremoved",index:e+u.length-1,item:a});for(var f=2,c=arguments.length;f<c;f++)t.splice(e,0,l[f]),i(t.length-1),o({type:"itemadded",index:e,item:l[f]}),e++;return u},Object.defineProperty(n,"length",{configurable:!1,enumerable:!1,get:function(){return t.length},set:function(e){var r=Number(e),i=t.length;if(!(r%1==0&&r>=0))throw new RangeError("Invalid array length");return r<i?n.splice(r):r>i&&n.push.apply(n,new Array(r-i)),t.length=r,e}}),Object.defineProperty(n,"innerArray",{configurable:!1,enumerable:!1,get:function(){return t},set:function(e){t=e;for(var n=0;n<e.length;n++)i(n)}}),Object.getOwnPropertyNames(Array.prototype).forEach(function(e){e in n||Object.defineProperty(n,e,{configurable:!1,enumerable:!1,writable:!1,value:Array.prototype[e]})}),n.toJSON=function(){return t},Array.isArray(e)&&n.push.apply(n,e)}var t=function(e,n){if(e&&null!=e.$val)throw"Fidan: Higher ordered signals is not supported.";var t=function(e){if(void 0===e)return t.$val;Array.isArray(e)?t.$val.innerArray=e:t.$val=e;var n=t.depends;if(n.length)for(var r=0;r<n.length;r++)!n[r].freezed&&n[r](n[r].compute())};return t.$val=e,t.freezed=n,t.depends=[],t.toString=t.toJSON=function(){return t.$val.toString()},t},r=function(e){var r=t(new n(e));return r.on=r.$val.on,r.off=r.$val.off,r.toJSON=function(){return r.$val.innerArray},r},i=function(e){for(var n=[],r=arguments.length-1;r-- >0;)n[r]=arguments[r+1];var i=t();i.compute=e;for(var o=0;o<n.length;o++)n[o].depends.push(i);e()},o=function(e){for(var n=[],r=arguments.length-1;r-- >0;)n[r]=arguments[r+1];var o=t(e());return i.apply(void 0,[function(){o(e())}].concat(n)),o},a=function(e){delete e.compute,delete e.depends},l=function(e,n,t){var r=typeof t;"function"===r?t(e):("object"!==r&&(t=document.createTextNode(t)),e.insertBefore(t,e.children[n]))},u=function(e,t,r){var o=e.$val instanceof n?e.$val:new n(e.$val),a=e.$val,u=null;o.on("beforemulti",function(){t.parentNode&&(u={parent:t,next:t.nextElementSibling},t=document.createDocumentFragment())}),o.on("aftermulti",function(){u&&(u.parent.insertBefore(t,u.next),t=u.parent)}),o.on("itemadded",function(e){l(t,e.index,r(e.item,e.index))}),o.on("itemset",function(e){t.replaceChild(r(e.item,e.index),t.children.item(e.index))}),o.on("itemremoved",function(e){t.removeChild(t.children.item(e.index))}),e(o);i(function(){if(0===a.length)t.textContent="";else{var e=null,n=document.createDocumentFragment();t.textContent="";for(var i=t.childElementCount;i<a.length;i++)"object"!=typeof(e=r(a[i],i))&&(e=document.createTextNode(e)),n.insertBefore(e,t.children[i]);t.appendChild(n)}},e)},f={id:!0,nodeValue:!0,textContent:!0,className:!0,innerHTML:!0,innerText:!0,tabIndex:!0,value:!0},c=!1,d=document.createElement("template"),s=function(e,n,t){for(var r=n;r>=0;r--){var i=e[r],o=i.lastIndexOf("<");if(-1!==o){e[r]=i.substr(0,o)+t+i.substr(o);break}}},p=function(e,n){var t=[];!function(e,n){for(var t=document.createTreeWalker(e,NodeFilter.SHOW_COMMENT,{acceptNode:function(e){return e.nodeValue.trim().startsWith("cmt_")?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_REJECT}},!1);t.nextNode();)n.push(t.currentNode)}(e,t);for(var r=function(e){var r=t[e],o=r.nodeValue,a=null,l=null,u=o.indexOf("_")+1,c=o.indexOf("_",u),d=parseInt(o.substr(u,c-u));u=o.indexOf("_",c)+1,-1===(c=o.indexOf("_",u))&&(c=o.indexOf(" ",u));var s=parseInt(o.substr(u,c-u)),p=n[s];if(3&d){if(1===d){if(l="textContent",a=document.createTextNode(p.$val),r.parentElement.insertBefore(a,r.nextSibling),!p.hasOwnProperty("$val")&&Array.isArray(p))for(var v=0;v<p.length;v++)r.parentElement.appendChild(p[v])}else 2===d&&(l=o.substr(c+1,o.length-c-2),a=r.nextElementSibling);l.startsWith("on")?a.addEventListener(l.substr(2),p):p.hasOwnProperty("$val")?i(f[l]?function(){a[l]=p.$val}:function(){a.setAttribute(l,p.$val)},p):f[l]?a[l]=p:a.setAttribute(l,p)}else 4===d?p(r):8===d&&r.parentElement.insertBefore(p,r.nextSibling)},o=0;o<t.length;o++)r(o)};return e.value=t,e.array=r,e.on=function(e,n,t){e.$val.on(n,t)},e.off=function(e,n,t){e.$val.off(n,t)},e.compute=i,e.initCompute=o,e.computeReturn=function(e){for(var n=[],t=arguments.length-1;t-- >0;)n[t]=arguments[t+1];return o.apply(void 0,[e].concat(n))},e.setCompute=function(e,n){for(var t=[],r=arguments.length-2;r-- >0;)t[r]=arguments[r+2];return a(e),o.apply(void 0,[e,n].concat(t))},e.destroy=a,e.insertToDom=l,e.arrayMap=u,e.setDefaults=function(e,n){for(var t in n)void 0===e[t]&&(e[t]=n[t])},e.mapProperty=function(e,n,r){var i=Object.getOwnPropertyDescriptor(e,n);i.configurable?Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:function(){return r.$val},set:r}):i.set.depends.push(t(function(){r(e[n])}))},e.html=function(){for(var e=[],n=arguments.length;n--;)e[n]=arguments[n];for(var t=e[0].slice(),r=e.slice(1),i=null,o=0,a=0;a<t.length;a++){var l=t[a],u=r[a];if(void 0===u)break;var f=u.hasOwnProperty("$val");f&&(void 0===u.$indexes&&(u.$indexes=[]),u.$indexes.push(a)),l.endsWith('="')?(o=l.lastIndexOf(" ")+1,i=l.substr(o,l.length-o-2),s(t,a,"\x3c!-- cmt_2_"+a+"_"+i+" --\x3e")):t[a]=l+"\x3c!-- cmt_"+("function"!=typeof u||f?"object"==typeof u?8:1:4)+"_"+a+" --\x3e"}(d=d.cloneNode(!1)).innerHTML=t.join("");var v=d.content;return v.$params=r,c||p(v,r),v},e.htmlArrayMap=function(e,n,t){if(Array.isArray(e)){var i=r(e);["copyWithin","fill","pop","push","reverse","shift","sort","splice","unshift"].forEach(function(n){return e[n]=i.$val[n]}),e=i}return t?function(t){var r=null,i=null,o=[];u(e,t.parentElement,function(e,t){var a=null;if(null===r){for(var l in c=!0,a=n(e),c=!1,i=a.$params,e)for(var u=e[l].$indexes,f=0;f<u.length;f++)o.push(u[f],l);r=a.cloneNode(!0)}else a=r.cloneNode(!0);for(f=0;f<o.length;f+=2)i[o[f]]=e[o[f+1]];return p(a,i),a})}:function(t){u(e,t.parentElement,n)}},e}({});
